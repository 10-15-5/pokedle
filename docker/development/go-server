# syntax=docker/dockerfile:1

#to create/update image from root:
#    docker build -t gabr0236/pokedle-server -f docker/go-server .

#to run container:
#   docker run --publish 3000:3000 gabr0236/pokedle-server:latest
FROM --platform=linux/x86_64 golang:1.19.5-alpine

WORKDIR /app

COPY /server/ /app/server/
COPY /server/data/pokemonData-v6-translations.json /app/data/

RUN cd /app/server && go mod download
RUN cd /app/server && go build -o /app/out

ENV CLIENT_URL=https://dev.pokedle.gg
ENV DOMAIN=https://dev.pokedle.gg
ENV MONGODB_URI=mongodb+srv://development:AXQiInOcUK9PrVSS@pokedlev1.a0jr10a.mongodb.net/test
ENV DATABASE=Dev
ENV ENVIRONMENT=development
ENV SERVER_PORT=3000

EXPOSE 3000

CMD [ "/app/out" ]